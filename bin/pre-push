#!/usr/bin/env bash

DEPLOY_BRANCH='master'
SYMBOLIC_REF="git symbolic-ref --short HEAD"

# https://stackoverflow.com/a/22585746
IFS=' '
while read local_ref local_sha remote_ref remote_sha
do
	echo "$local_ref $local_sha $remote_ref $remote_sha"
done

# Only run if pushing master or forced via environment variable
# e.g.
#
# ```bash
# HUSKY_FORCE_PREPUSH=1 git push
# ```
if [[ $SYMBOLIC_REF = $DEPLOY_BRANCH ]] || [[ ! -z ${HUSKY_FORCE_PREPUSH+x} ]] ; then
	npm run pre-push
else
	exit 0
fi
