#!/usr/bin/env bash

DEPLOY_BRANCH='master'
SYMBOLIC_REF="git symbolic-ref --short HEAD"

# https://github.com/typicode/husky/pull/253
IFS=' '
read -ra arr <<<"$HUSKY_GIT_STDIN"
for a in "${arr[@]}"; do echo "[$a]"; done

# Only run if pushing master or forced via environment variable
# e.g.
#
# ```bash
# HUSKY_FORCE_PREPUSH=1 git push
# ```
if [[ $SYMBOLIC_REF = $DEPLOY_BRANCH ]] || [[ ! -z ${HUSKY_FORCE_PREPUSH+x} ]] ; then
	npm run pre-push
else
	exit 0
fi
